# Практическая работа - создание и запуск playbook-а Ansible
На данном этапе урока студенты должны применить свои собственные playbook-и, созданные в предыдущем разделе. Если у вас есть доступ к виртуальным машинам или симулированным окружениям, каждый студент может подключиться к своей виртуальной системе и запустить playbook. Если нет, можно использовать локальные симуляции или виртуальные контейнеры.</p>
•	Цель практической работы: установить программное обеспечение (веб-сервер Apache) на удалённых серверах или виртуальных машинах с помощью созданных playbook-ов. Затем мы внесем изменения в веб-страницу и транслируем изменения на сервера автоматически с использованием Ansible.
<p><b>Часть-1 Подготовка к работе с Ansible</b></p>
<p>•	Запустите терминал на виртуальной машине, создайте в каталоге пользователя папку проекта <b>ansible_project</b></p>
<p>•	Проверьте установлен ли у вас ansible:<br><b>ansible --version</b> (для установки используйте <b>sudo apt install ansible</b>)</p>
<p>•	Добавьте локальную симуляцию хостов - localhost:<br>
перейдите в каталог <b>/etc</b> затем перейдите, либо создайте папку <b>ansible</b>, в ней создайте, либо откройте на редактирование файл hosts (*)<br>
* - в файле /etc/ansible/hosts указывается список хостов, с которыми должен работать ansible.
</p>
<pre class="p-3 text-white bg-dark"><code>
[control]
localhost ansible_connection=local
</code></pre>
<p>Здесь мы:<br>
•	создали группу control;<br>
•	определили в ней один хост c адресом localhost (можно указать любой доступный IP);<br>
•	дополнительно для хоста localhost указали тип соединения local.<br>
<br>
Обычно при работе с удаленными хостами Ansible соединяется с ними по SSH и выполняет определенные в скрипте операции. Однако, поскольку мы выполняем действия локально, то Ansible позволяет указать дополнительный параметр ansible_connection, который определит тип соединения как local.
</p>
<p>Попробуйте пропинговать хосты на отклик (в нашем случае единственный хост): </p>
<p><b>ansible all -m ping</b></p>
<p><b>Часть-2 Запуск плейбука Ansible</b></p>
<p>•	Перейдите в каталог проекта <b>ansible-project</b></p>
<p>•	Создайте плейбук <b>web_playbook.yml</b></p>
<pre class="p-3 text-white bg-dark"><code>---
- hosts: all
  become: yes
  tasks:
    - name: Install apache
      apt:
        name: apache2
        state: present
</code></pre>
<p>•	Запустите плейбук на выполнение<br>
<b>ansible-playbook web_playbook.yml</b></p>
<p>•	Проверьте запуск веб-сервера арасhe, вызвав в браузере: <b>http://localhost</b></p>
<p>•	Добавьте в папку проекта файл  index.html следующего содержания:</p> 
<pre class="p-3 text-white bg-dark"><code>< h1 >
Hello, Ansible!
< /h1 ></code></pre>
<p>Добавьте в плейбук новую задачу:</p>
<pre class="p-3 text-white bg-dark"><code>    - name: Copy new index.html
      copy:
        src: ./index.html
        dest: /var/www/html
</code></pre>
<p>Запустите на выполнение и проверьте что файл обновился, вызвав в браузере: <b>http://localhost</b></p>
